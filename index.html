<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <!-- بقیه تگ‌های head ... -->
</head>
<body>
    <!-- صفحه اصلی -->
    <div class="container main-page active" id="main-page">
        <header>
            <div class="language-switcher">
                <button class="language-btn btn-outline" id="lang-fa">فارسی</button>
                <button class="language-btn btn-outline" id="lang-en">English</button>
            </div>
            <div class="auth-buttons" id="auth-buttons">
                <!-- توسط جاوااسکریپت پر می‌شود -->
            </div>
        </header>
        
        <!-- بقیه محتوای HTML ... -->
    </div>

    <script>
        // ... توابع و متغیرهای قبلی ...

        // تابع جدید برای به‌روزرسانی دکمه‌های احراز هویت
        function updateAuthButtons() {
            const authButtons = document.getElementById('auth-buttons');
            const currentLang = document.documentElement.lang;
            const t = translations[currentLang];
            
            if (localStorage.getItem('isLoggedIn')) {
                const userName = localStorage.getItem('userName') || 'کاربر';
                authButtons.innerHTML = `
                    <button class="auth-btn btn-outline user-profile">
                        <i class="fas fa-user"></i> ${userName}
                    </button>
                    <button class="auth-btn btn-outline" id="logout-btn">
                        ${t.logout}
                    </button>
                `;
                
                document.getElementById('logout-btn').addEventListener('click', logout);
            } else {
                authButtons.innerHTML = `
                    <button class="auth-btn btn-outline" id="login-btn">${t.login}</button>
                    <button class="auth-btn btn-primary" id="register-btn">${t.register}</button>
                `;
                
                document.getElementById('login-btn').addEventListener('click', () => {
                    document.getElementById('login-modal').style.display = 'flex';
                });
                
                document.getElementById('register-btn').addEventListener('click', () => {
                    document.getElementById('register-modal').style.display = 'flex';
                });
            }
        }

        // تابع تغییر زبان با اضافه شدن فراخوانی updateAuthButtons
        function changeLanguage(lang) {
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'fa' ? 'rtl' : 'ltr';
            document.body.className = lang === 'en' ? 'english' : '';
            
            const t = translations[lang];
            
            // به‌روزرسانی متن‌ها
            document.querySelector('.title').textContent = t.title;
            // ... بقیه به‌روزرسانی‌ها
            
            updateAuthButtons(); // این خط اضافه شده
        }

        // مدیریت ثبت نام با اضافه شدن updateAuthButtons
        const registerForm = document.getElementById('register-form');
        registerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ... اعتبارسنجی و پردازش فرم ...
            
            // ذخیره اطلاعات کاربر
            localStorage.setItem('userName', name);
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userPhone', phone);
            localStorage.setItem('userPassword', password);
            localStorage.setItem('isLoggedIn', 'true');
            
            setTimeout(() => {
                registerModal.style.display = 'none';
                registerForm.reset();
                updateAuthButtons(); // این خط اضافه شده
                checkRegistration();
            }, 3000);
        });

        // مدیریت ورود با اضافه شدن updateAuthButtons
        const loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ... اعتبارسنجی و پردازش فرم ...
            
            setTimeout(() => {
                loginModal.style.display = 'none';
                loginForm.reset();
                updateAuthButtons(); // این خط اضافه شده
            }, 2000);
        });

        // مقداردهی اولیه
        updateAuthButtons(); // این خط اضافه شده
        changeLanguage('fa');
        checkRegistration();
    </script>
</body>
</html>
